language: rust


addons:
  apt:
    packages:
    - libasound2-dev


rust:
  - stable
  - beta
  - nightly


matrix:
  allow_failures:
    - rust: nightly
  fast_finish: true


script:
  - cargo build --verbose
  - cargo test --verbose --features empty


    # If we're building a tag, then publish to crates.io.
    # - if [ ! -z "$TRAVIS_TAG" ]; then cargo publish --token $CRATES_TOKEN; fi
    #
    # env:
    #   global:
    #     secure: <sth>


# from: https://github.com/japaric/trust/blob/master/.travis.yml
# deploy:
#   # TODO update `api_key.secure`
#   # - Create a `public_repo` GitHub token. Go to: https://github.com/settings/tokens/new
#   # - Encrypt it: `travis encrypt 0123456789012345678901234567890123456789
#   # - Paste the output down here
#   api_key:
#     secure: <sth>
#   file_glob: true
#   file: $CRATE_NAME-$TRAVIS_TAG-$TARGET.*
#   on:
#     # TODO Here you can pick which targets will generate binary releases
#     # In this example, there are some targets that are tested using the stable
#     # and nightly channels. This condition makes sure there is only one release
#     # for such targets and that's generated using the stable channel
#     condition: $TRAVIS_RUST_VERSION = stable
#     tags: true
#   provider: releases
#   skip_cleanup: true




cache: cargo
before_cache:
  # Travis can't cache files that are not readable by "others"
  - chmod -R a+r $HOME/.cargo


branches:
  only:
    # release tags
    - /^v\d+\.\d+\.\d+.*$/
    - master


notifications:
  email:
    on_success: never

